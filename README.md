# TruEnd-Procedure
 [![DOI](https://zenodo.org/badge/695033824.svg)](https://zenodo.org/doi/10.5281/zenodo.10908342)

 A novel procedure is presented for finding the true but latent endpoints within the repayment histories of individual loans. The monthly observations beyond these true endpoints are false, largely due to operational or system failures that otherwise delay the timely closure of loans, thereby corrupting the eventual dataset. However, these false observations are difficult to detect at scale since each affected loan history might have a different sequence of zero (or very small) month-end balances that persist towards the end. Identifying and discarding these trails of diminutive balances will depend on the exact definition of a "small balance". Our procedure can find such an optimised balance-definition that is neither too small nor too large, such that we retain neither false history nor discard credible history across all loans. We demonstrate this procedure using a dataset of residential mortgages, as provided by a large South African bank, and we isolate the ideal small-balance definition for this portfolio. Evidently, the affected loans within this portfolio are both remarkably prevalent and have excess histories that are surprisingly long. These excess histories ruin the timing of certain risk events such as write-off and early settlement, thereby compromising any subsequent time-to-event model such as survival analysis, as demonstrated. Discarding these excess histories demonstrably improves the accuracy of both the predicted timing and severity of risk events, without impacting the monetary value of the portfolio in any material way. In turn, the resulting estimates of credit losses are lower and less biased, which augurs well for raising accurate credit impairments under the IFRS 9 accounting standard. Our work therefore highlights and solves a data problem that essentially amounts to measurement error, thereby underscoring the pivotal role of data preparation in producing credible forecasts of credit risk.

 ## Structure
This R-codebase can be run sequentially using the file numbering itself as a structure. Delinquency measures are algorithmically defined in **DelinqM.R** as data-driven functions, which may be valuable to the practitioner outside of the study's current scope. The TruEnd-procedure and its set of funcations are defined in **TruEnd.R**, which may also be valuable to the practitioner beyond the current scope.

## Data
This R-codebase assumes that monthly loan performance data is available. Naturally, the data itself can't be made publically available given its sensitive nature, as well as various data privacy laws, particularly the _Protection of Personal Information (POPI)_ Act of 2013 in South Africa. However, the structure and type of data that is required for reproducing this study, is sufficiently described in the commentary within the scripts. This should enable the practitioner to extract and prepare data accordingly. Moreover, this codebase assumes South African macroeconomic data is available, as sourced and collated by internal staff of the bank in question.

## Copyright
All code and scripts are hereby released under an [MIT](https://opensource.org/licenses/MIT) license. Similarly, all graphs produced by relevant scripts as well as those published here, are hereby released under a Creative Commons Attribution ([CC-BY 4.0](https://creativecommons.org/licenses/by/4.0/)) licence.
